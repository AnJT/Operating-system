# 电梯调度 项目文档

> 题目：电梯调度
>
> 指导教师：张慧娟
>
> 姓名：安江涛
>
> 学号：1952560

## 一、项目概述

​	本项目设计的是一个电梯调度系统。

​	在本项目实现的电梯调度系统中：共有5部电梯，楼层总共高度为20层，每层楼设有一个“向上”按钮和一个“向下”按钮。每一部电梯内设置有各楼层的数字键、关门键、开门键、上行建、下行键和报警键。

​	电梯调度算法支持多电梯独立运行，联合调度。对于每一个单独电梯采用LOOK算法进行调度，对于楼层按钮产生的请求通过调度器联合调度电梯来响应任务，通过将请求根据算法计算分配给一个电梯，从而使得在最短的时间内响应楼层请求。

​	本项目基于PyQt5实现，具有清晰的可视化界面。项目支持通过点击楼层按钮或电梯内部按钮来模拟实际电梯中的功能，并通过UI的变化来展示电梯的具体调度过程。

## 二、功能描述

1. 每个电梯里设置必要功能键：数字键、关门键、开门键、上行建、下行键和报警键。
2. 每层楼的每部电梯门口，应该有上行和下行按钮和当前电梯状态的数码显示器。
3. 五部电梯门口的按钮是互联结的，即当一个电梯按钮按下去时，其他电梯的相应按钮也就同时点亮，表示也按下去了。
4. 所有电梯初始状态都在第一层。每个电梯如果在它的上层或者下层没有相应请求情况下，则应该在原地保持不动。

## 三、项目方案

### 1. 单独电梯调度算法——LOOK算法

- #### 原理：

  > LOOK算法是扫描算法的一种改进。扫描算法(SCAN)是一种按照楼层顺序依次服务请求的算法，它让电梯在最底层和最顶层之间连续往返运行，在运行过程中响应处在于电梯运行方向相同的各楼层上的请求。扫描算法较好地解决了电梯移动的问题，在这个算法中，每个电梯响应乘客请求使乘客获得服务的次序是由其发出请求的乘客的位置与当前电梯位置之间的距离来决定的，所有的与电梯运行方向相同的乘客的请求在一次电梯向上运行或向下运行的过程中完成，免去了电梯频繁的来回移动。对LOOK算法而言，电梯同样在最底层和最顶层之间运行。但当LOOK算法发现电梯所移动的方向上不再有请求时立即改变运行方向，而扫描算法则需要移动到最底层或者最顶层时才改变运行方向。

- #### 实现

  - 设置一个队列messages用来存储电梯顺路时的请求

  - 设置一个队列messages_reverse用来存储不顺路的请求

  - 电梯有两种状态：RUNNING_UP(上行状态)和RUNNING_DOWN(下行状态)

  - **流程图**：

    <img src="https://github.com/AnJT/IMG/blob/main/%E8%AF%B7%E6%B1%82.png?raw=true" height="400">

    <img src="https://github.com/AnJT/IMG/blob/main/look.png?raw=true" height="400">

### 2. 联合电梯调度算法

- #### 算法策略：

  > 综合电梯运行状态以及目前已有的请求，计算出耗时最短的电梯，并将改请求加入到该电梯相应的消息队列中。

- ### 实现：

  - 设置一个队列messages用来存储电梯顺路时的请求

  - 设置一个队列messages_reverse用来存储与电梯运行方向反向的请求

  - 设置一个队列messages_other用来存储与电梯运行方向同向但是不顺路的请求

  - 电梯有两种状态：RUNNING_UP(上行状态)和RUNNING_DOWN(下行状态)

  - **流程图**：

    <img src="https://github.com/AnJT/IMG/blob/main/%E8%AF%B7%E6%B1%822.png?raw=true" height="500">

    <img src="https://github.com/AnJT/IMG/blob/main/%E5%A4%96.png?raw=true" height="500">

## 四、 项目操作说明

- 主界面：

  <img src="https://github.com/AnJT/IMG/blob/main/elev2.png?raw=true">

- 运行时：

  <img src="https://github.com/AnJT/IMG/blob/main/elev3.png?raw=true">

## 五、 总结

- 在实现电梯调度项目中运用了操作系统课程中所学的多线程并发技巧、进程状态转换、进程调度等知识。

#### 1. 亮点：

- 对于每个电梯遵守LOOK算法进行了优化了电梯处理任务的方式。
- 多电梯之间采用联合调度方法，权衡了乘客耗费时间最少和电梯运行成本（距离）最少。

#### 2. 展望：

- 在电梯群控算法中，存在两个优化目标：1.乘客耗费时间最少 2. 电梯运行成本（距离）最少。基于这两个目标有很多优秀的算法成果，本项目只是采用了较为基础的一个调度算法。基于特定的时间段乘坐电梯的特征以及具体数据分布情况，还有非常大的优化空间。
- 暂时没有考虑电梯的载荷问题。

## 六、项目部署与构建

- 仓库地址：

  https://github.com/AnJT/Operating-system

- 开发工具：

  - 开发环境：

    Windows 10

    VS Code

- 项目构建：

  `pip install PyQt5`
  
  `pip install pyqt5-tools`
  
  `python main.py`
  
- 项目结构

  │  README.md
  │  
  ├─resources
  │      down.png
  │      down_hover.png
  │      down_pressed.png
  │      state.png
  │      state_down.png
  │      state_up.png
  │      up.png
  │      up_hover.png
  │      up_pressed.png
  │      
  └─src
         dispatch.py
         elevator.py
         main.py
         style.qss

